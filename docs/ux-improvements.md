# UX 改進規格討論

## 問題 1: 長文字瀏覽

### 現況
- 文字區塊高度固定，長文字被截斷
- 用戶無法看到完整內容

### 方案比較

| 方案 | 優點 | 缺點 |
|------|------|------|
| **A. 固定高度 + 滾動** | 簡單實作、視窗大小不變 | 需要滾動操作 |
| **B. 自動展開** | 不需滾動 | 視窗可能變太大 |
| **C. 彈出面板** | 可全螢幕閱讀 | 多一層操作 |
| **D. 混合模式** | 彈性 | 實作複雜 |

### 建議方案: A + C 混合

1. **預設**: 文字區塊固定高度 (約 150px)，超過可滾動
2. **展開按鈕**: 點擊可展開到更大高度 (約 300px)
3. **全螢幕按鈕**: 長文字時顯示「展開」按鈕，彈出獨立面板

### UI 設計
```
┌─────────────────────────────┐
│ [圖片預覽]                   │
├─────────────────────────────┤
│ 辨識文字內容...              │ ← 可滾動區域
│ 第二行...                    │
│ 第三行...                    │
│ ▼ 展開更多                   │ ← 超過 5 行時顯示
└─────────────────────────────┘
```

---

## 問題 2: OCR 中斷機制

### 現況
- Tesseract 執行中無法取消
- PaddleOCR 執行中無法取消
- 用戶必須等待完成才能切換 AI

### 技術限制
- Tesseract.js: 支援 `terminate()` 中斷
- PaddleOCR: 無原生中斷支援，需要 worker 方式
- Gemini API: 可用 AbortController 取消

### 方案比較

| 方案 | 優點 | 缺點 |
|------|------|------|
| **A. 取消按鈕** | 用戶主動控制 | 需要額外 UI |
| **B. 自動超時** | 不需操作 | 可能誤殺 |
| **C. AI 優先** | 快速切換 | 浪費 OCR 運算 |
| **D. 並行執行** | 誰快用誰 | 資源消耗大 |

### 建議方案: A (取消按鈕)

1. **Loading 狀態時顯示取消按鈕**
2. **點取消後可立即選擇 AI 辨識**
3. **Tesseract 用 terminate() 真正中斷**

### UI 設計
```
┌─────────────────────────────┐
│ [圖片預覽]                   │
├─────────────────────────────┤
│     ⏳ 辨識中...             │
│     [取消] [改用 AI]         │ ← 新增按鈕
└─────────────────────────────┘
```

### 實作細節

```typescript
// OCR 取消機制
class OcrController {
  private worker: Tesseract.Worker | null = null
  private abortController: AbortController | null = null

  async recognize(image: string): Promise<OcrResult> {
    this.abortController = new AbortController()
    // ...
  }

  cancel(): void {
    if (this.worker) {
      this.worker.terminate()
      this.worker = null
    }
    if (this.abortController) {
      this.abortController.abort()
    }
  }
}
```

---

## 實作優先順序

1. **P0 - 文字滾動**: 立即可做，影響大
2. **P1 - 取消按鈕 UI**: 簡單，改善體驗
3. **P2 - Tesseract 中斷**: 需要改 OCR 架構
4. **P3 - 展開面板**: 錦上添花

---

## 討論問題

1. 文字區塊要多高？150px? 200px?
2. 取消後要顯示什麼？空白 or 保留圖片?
3. AI 按鈕要不要改成更明顯的位置？
